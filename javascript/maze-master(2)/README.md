# Maze 游戏说明文档
## 游戏说明
* 游戏有两个maze形式，maze1为普通迷宫，maze2为随机生成迷宫。create键产生地图。灰色为地面，黑色为墙壁。通过点击两个灰色部分作为起点和终点，电脑会自动生成最短路径。maze1只能走上下左右4个节点，maze2可以走响铃8个节点。生成迷宫和生成路径均可以开启和关闭动画。使用skip键跳过动画。使用clear键清空上一次的路径，即可重新制定起点终点。
* 可以调节maze的行列数，maze2中可以调节空地生成率density1，以及空地中地面生成率density2。蓝色为水面。还可以选择用以作为maze2中A*寻路算法的估值函数getG。
* maze的下方有一个展示使用步数的step。maze2中的斜对角步数为根号2，走到水域中的步数为响应的走到陆地中步数的2倍。
## 算法实现
### maze1
* maze1的地图大小设置为奇数乘奇数。设置随机起点，并使它的行数列数都为偶数（从0开始数），随机取四个方向没有遍历的随机邻节点，开始深度优先遍历，每次前进两格，没有符合条件的邻节点再回退。
* 因此整个迷宫可以看成一棵树，可以用最近祖先节点算法找（LCA）。在生成迷宫时就用depth和parent两个表分别记录每个空地节点的深度和父节点方向。得到起点终点后先将两点中深度较大的点沿父节点走到与另一节点同一深度处，再两点共同沿父节点向上走，直到两点相遇。
* 动画中将深度较深的结点走到较浅深度的过程标记为黄，将两个节点一起走的过程标记为红色。
### maze2
* maze2的生成是简单的取随机数。density1为灰色、蓝色节点占总地图的百分比，density2为灰色占灰色蓝色的百分比。
* 寻路算法使用A*算法。由于这是我自己凭印象写的，其中的FGH分别对应常见教程中的GHF。因为可以向8个方向前进，推荐使用对角距离（误标为Chebyshev）作为估值函数G。使用曼哈顿距离可能得不到最短路径。使用欧几里得距离的话，在这个规则下没有相对于选择距离作为G函数的优势，且要开根号，开销较大。
* 使用最小堆作为openList来优化A*算法，每次pop和push的时间复杂度为logn。为了使find的时间复杂度降低，使用findMap映射每一个点在openList中的位置，且每次进行pop和push时都进行维护，使find操作复杂度为常数。
* 动画中将openList中的陆地标为红色，closeList中的陆地标为深红，openList中的水域标为绿色，closeList中的水域标为深绿，最终路径中的路基标为黄色，最终路径中的水域标为橘黄。若找不到路径则弹出提示no path。
